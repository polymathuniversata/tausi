<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tausi - Project Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .step { display: none; }
        .step.active { display: block; }
        .logo-animation {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <div class="flex items-center justify-center mb-4">
                <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center logo-animation">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2L2 7v10l10 5 10-5V7l-10-5z"/>
                    </svg>
                </div>
                <h1 class="text-4xl font-bold text-gray-900 ml-4">Tausi</h1>
            </div>
            <p class="text-lg text-gray-600">LLM-friendly project generator</p>
            <p class="text-sm text-gray-500">Vite + Tailwind + Express + Firebase</p>
        </header>

        <!-- Main Content -->
        <div class="max-w-4xl mx-auto">
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm text-gray-500">Step <span id="currentStep">1</span> of 4</span>
                    <span class="text-sm text-gray-500"><span id="progressPercent">25</span>%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progressBar" class="bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300" style="width: 25%"></div>
                </div>
            </div>

            <!-- Steps -->
            <div class="bg-white rounded-lg shadow-lg p-8">
                <!-- Step 1: Basic Info -->
                <div class="step active" id="step1">
                    <h2 class="text-2xl font-bold mb-6">Project Information</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Project Name</label>
                            <input type="text" id="projectName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="my-awesome-app">
                            <p class="text-sm text-gray-500 mt-1">Use lowercase letters, numbers, and hyphens only</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <textarea id="projectDescription" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" rows="3" placeholder="A description of your project"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Author</label>
                            <input type="text" id="projectAuthor" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Your Name">
                        </div>
                    </div>
                </div>

                <!-- Step 2: Tech Stack -->
                <div class="step" id="step2">
                    <h2 class="text-2xl font-bold mb-6">Tech Stack Configuration</h2>
                    <div class="space-y-6">
                        <div class="bg-gray-50 rounded-lg p-6">
                            <h3 class="font-semibold mb-4">Frontend (Fixed)</h3>
                            <div class="grid grid-cols-3 gap-4">
                                <div class="text-center p-4 bg-white rounded border">
                                    <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 2L2 7v10l10 5 10-5V7l-10-5z"/>
                                        </svg>
                                    </div>
                                    <p class="text-sm font-medium">Vite</p>
                                </div>
                                <div class="text-center p-4 bg-white rounded border">
                                    <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-lg flex items-center justify-center">
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 6c-2.67 0-4.33 1.33-5 4 1-1.33 2.17-1.83 3.5-1.5.76.19 1.31.74 1.91 1.35.98 1 2.12 2.15 4.59 2.15 2.67 0 4.33-1.33 5-4-1 1.33-2.17 1.83-3.5 1.5-.76-.19-1.31-.74-1.91-1.35C15.61 7.15 14.47 6 12 6zm-5 6c-2.67 0-4.33 1.33-5 4 1-1.33 2.17-1.83 3.5-1.5.76.19 1.31.74 1.91 1.35.98 1 2.12 2.15 4.59 2.15 2.67 0 4.33-1.33 5-4-1 1.33-2.17 1.83-3.5 1.5-.76-.19-1.31-.74-1.91-1.35C10.61 13.15 9.47 12 7 12z"/>
                                        </svg>
                                    </div>
                                    <p class="text-sm font-medium">Tailwind</p>
                                </div>
                                <div class="text-center p-4 bg-white rounded border">
                                    <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-lg flex items-center justify-center">
                                        <span class="text-white font-bold text-sm">JS</span>
                                    </div>
                                    <p class="text-sm font-medium">Vanilla JS</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-lg p-6">
                            <h3 class="font-semibold mb-4">Backend (Fixed)</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="text-center p-4 bg-white rounded border">
                                    <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center">
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 2L2 7v10l10 5 10-5V7l-10-5z"/>
                                        </svg>
                                    </div>
                                    <p class="text-sm font-medium">Express.js</p>
                                </div>
                                <div class="text-center p-4 bg-white rounded border">
                                    <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-r from-red-500 to-pink-500 rounded-lg flex items-center justify-center">
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 2L2 7v10l10 5 10-5V7l-10-5z"/>
                                        </svg>
                                    </div>
                                    <p class="text-sm font-medium">CORS Security</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-lg p-6">
                            <h3 class="font-semibold mb-4">Authentication (Optional)</h3>
                            <div class="space-y-4">
                                <label class="flex items-center">
                                    <input type="checkbox" id="includeAuth" class="mr-3 rounded">
                                    <span>Include Firebase Authentication</span>
                                </label>
                                <p class="text-sm text-gray-500">Adds Firebase Auth for user management</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Deployment -->
                <div class="step" id="step3">
                    <h2 class="text-2xl font-bold mb-6">Deployment Configuration</h2>
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-4">Deployment Target</label>
                            <div class="space-y-3">
                                <label class="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="deployTarget" value="railway" class="mr-3">
                                    <div class="flex-1">
                                        <p class="font-medium">Railway</p>
                                        <p class="text-sm text-gray-500">Deploy to Railway platform</p>
                                    </div>
                                </label>
                                <label class="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="deployTarget" value="render" class="mr-3">
                                    <div class="flex-1">
                                        <p class="font-medium">Render</p>
                                        <p class="text-sm text-gray-500">Deploy to Render platform</p>
                                    </div>
                                </label>
                                <label class="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="deployTarget" value="both" class="mr-3" checked>
                                    <div class="flex-1">
                                        <p class="font-medium">Both</p>
                                        <p class="text-sm text-gray-500">Include configs for both platforms</p>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div class="bg-blue-50 rounded-lg p-6">
                            <h3 class="font-semibold mb-2">What's Included</h3>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>• Docker configurations</li>
                                <li>• Railway/Render deployment files</li>
                                <li>• Environment variable templates</li>
                                <li>• CI/CD ready structure</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Review -->
                <div class="step" id="step4">
                    <h2 class="text-2xl font-bold mb-6">Review & Generate</h2>
                    <div class="space-y-6">
                        <div class="bg-gray-50 rounded-lg p-6">
                            <h3 class="font-semibold mb-4">Project Summary</h3>
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div>
                                    <span class="font-medium">Name:</span>
                                    <span id="reviewName" class="ml-2"></span>
                                </div>
                                <div>
                                    <span class="font-medium">Author:</span>
                                    <span id="reviewAuthor" class="ml-2"></span>
                                </div>
                                <div>
                                    <span class="font-medium">Auth:</span>
                                    <span id="reviewAuth" class="ml-2"></span>
                                </div>
                                <div>
                                    <span class="font-medium">Deploy:</span>
                                    <span id="reviewDeploy" class="ml-2"></span>
                                </div>
                            </div>
                            <div class="mt-4">
                                <span class="font-medium">Description:</span>
                                <p id="reviewDescription" class="mt-1 text-gray-600"></p>
                            </div>
                        </div>

                        <div class="bg-green-50 rounded-lg p-6">
                            <h3 class="font-semibold mb-2">Generated Structure</h3>
                            <pre class="text-sm text-gray-600 overflow-x-auto">
<span id="reviewName2">project-name</span>/
├── frontend/     # Vite + Tailwind + Vanilla JS
├── backend/      # Express.js + Security
├── docs/         # Architecture + LLM context
└── deployment/   # Railway & Render configs</pre>
                        </div>

                        <div id="generationResult" class="hidden">
                            <div class="bg-blue-50 rounded-lg p-6">
                                <h3 class="font-semibold mb-2">✅ Project Generated!</h3>
                                <p class="text-sm text-gray-600 mb-4">Your project has been created successfully.</p>
                                <div class="bg-white rounded p-4 font-mono text-sm">
                                    <div>Next steps:</div>
                                    <div class="text-gray-600">cd <span id="projectPath"></span></div>
                                    <div class="text-gray-600">bun install</div>
                                    <div class="text-gray-600">bun run dev</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation -->
                <div class="flex justify-between mt-8">
                    <button id="prevBtn" class="px-6 py-2 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50" disabled>Previous</button>
                    <button id="nextBtn" class="px-6 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-md hover:from-purple-600 hover:to-pink-600">Next</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 4;

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentStep').textContent = currentStep;
            document.getElementById('progressPercent').textContent = progress;
        }

        function showStep(step) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById('step' + step).classList.add('active');
            
            document.getElementById('prevBtn').disabled = step === 1;
            document.getElementById('nextBtn').textContent = step === totalSteps ? 'Generate Project' : 'Next';
        }

        function updateReview() {
            document.getElementById('reviewName').textContent = document.getElementById('projectName').value || 'my-project';
            document.getElementById('reviewName2').textContent = document.getElementById('projectName').value || 'my-project';
            document.getElementById('reviewAuthor').textContent = document.getElementById('projectAuthor').value || 'Not specified';
            document.getElementById('reviewDescription').textContent = document.getElementById('projectDescription').value || 'No description provided';
            document.getElementById('reviewAuth').textContent = document.getElementById('includeAuth').checked ? 'Firebase Auth' : 'No Auth';
            document.getElementById('reviewDeploy').textContent = document.querySelector('input[name="deployTarget"]:checked').value;
        }

        function validateStep(step) {
            if (step === 1) {
                const name = document.getElementById('projectName').value;
                if (!name || !/^[a-zA-Z0-9-_]+$/.test(name)) {
                    alert('Please enter a valid project name (letters, numbers, hyphens, and underscores only)');
                    return false;
                }
            }
            return true;
        }

        async function generateProject() {
            const config = {
                name: document.getElementById('projectName').value,
                description: document.getElementById('projectDescription').value,
                author: document.getElementById('projectAuthor').value,
                includeAuth: document.getElementById('includeAuth').checked,
                deployTarget: document.querySelector('input[name="deployTarget"]:checked').value
            };

            try {
                document.getElementById('nextBtn').textContent = 'Generating...';
                document.getElementById('nextBtn').disabled = true;
                
                const response = await fetch('/api/generate-project', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    document.getElementById('projectPath').textContent = config.name;
                    document.getElementById('generationResult').classList.remove('hidden');
                    document.getElementById('nextBtn').textContent = 'Create Another Project';
                    document.getElementById('nextBtn').onclick = () => window.location.reload();
                } else {
                    alert('Error generating project: ' + result.error);
                    document.getElementById('nextBtn').textContent = 'Generate Project';
                    document.getElementById('nextBtn').disabled = false;
                }
                
            } catch (error) {
                alert('Error generating project: ' + error.message);
                document.getElementById('nextBtn').textContent = 'Generate Project';
                document.getElementById('nextBtn').disabled = false;
            }
        }

        document.getElementById('nextBtn').addEventListener('click', async () => {
            if (currentStep < totalSteps) {
                if (!validateStep(currentStep)) return;
                
                if (currentStep === 3) {
                    updateReview();
                }
                
                currentStep++;
                showStep(currentStep);
                updateProgress();
            } else {
                await generateProject();
            }
        });

        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
                updateProgress();
            }
        });

        // Auto-fill project name based on input
        document.getElementById('projectName').addEventListener('input', (e) => {
            const name = e.target.value.toLowerCase().replace(/[^a-z0-9-_]/g, '');
            if (name !== e.target.value) {
                e.target.value = name;
            }
        });

        // Initialize
        updateProgress();
    </script>
</body>
</html>
